<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>üéÑ Merry Christmas üéÅ</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<style>
html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
    touch-action: none;
    font-family: 'Segoe UI', sans-serif;
}

#startBtn {
    position: absolute;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    padding: 16px 50px;
    border-radius: 40px;
    border: 2px solid gold;
    background: linear-gradient(#c62828, #8b0000);
    color: white;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    animation: pulse 1.5s infinite;
    z-index: 10;
}

@keyframes pulse {
    0% { transform: translateX(-50%) scale(1); }
    50% { transform: translateX(-50%) scale(1.08); }
    100% { transform: translateX(-50%) scale(1); }
}

#hint {
    position: absolute;
    bottom: 95px;
    width: 100%;
    text-align: center;
    color: rgba(255,255,255,0.7);
    font-size: 13px;
}
</style>
</head>

<body>

<div id="hint">‚ùÑÔ∏è Ch·∫°m ƒë·ªÉ b·∫Øt ƒë·∫ßu m√≥n qu√† Noel ‚ùÑÔ∏è</div>
<button id="startBtn">START MAGIC üéÑ</button>

<script>
// ================================
// GLOBAL
// ================================
let scene, camera, renderer;
let snow, magic;
let started = false;

// ================================
// PARTICLE TEXTURE (TR√íN - M·ªäN)
// ================================
function createParticleTexture() {
    const canvas = document.createElement("canvas");
    canvas.width = canvas.height = 64;
    const ctx = canvas.getContext("2d");

    const g = ctx.createRadialGradient(32,32,0,32,32,32);
    g.addColorStop(0,"rgba(255,255,255,1)");
    g.addColorStop(0.4,"rgba(255,255,255,0.8)");
    g.addColorStop(1,"rgba(255,255,255,0)");

    ctx.fillStyle = g;
    ctx.fillRect(0,0,64,64);

    return new THREE.CanvasTexture(canvas);
}

const particleTexture = createParticleTexture();

// ================================
// INIT
// ================================
function init() {
    scene = new THREE.Scene();

    camera = new THREE.PerspectiveCamera(
        65,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
    );
    camera.position.z = 120;

    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    document.body.appendChild(renderer.domElement);

    createSnow();
    createMagic();
    animate();
}

// ================================
// SNOW ‚ùÑÔ∏è
// ================================
function createSnow() {
    const count = window.innerWidth < 768 ? 1200 : 2500;
    const geo = new THREE.BufferGeometry();
    const pos = [];

    for (let i = 0; i < count; i++) {
        pos.push(
            (Math.random() - 0.5) * 400,
            Math.random() * 300,
            (Math.random() - 0.5) * 400
        );
    }

    geo.setAttribute("position", new THREE.Float32BufferAttribute(pos, 3));

    const mat = new THREE.PointsMaterial({
        map: particleTexture,
        color: 0xffffff,
        size: 2.5,
        transparent: true,
        depthWrite: false
    });

    snow = new THREE.Points(geo, mat);
    scene.add(snow);
}

// ================================
// MAGIC GOLD ‚ú®
// ================================
function createMagic() {
    const count = window.innerWidth < 768 ? 800 : 1600;
    const geo = new THREE.BufferGeometry();
    const pos = [];

    for (let i = 0; i < count; i++) {
        pos.push(
            (Math.random() - 0.5) * 60,
            (Math.random() - 0.5) * 60,
            (Math.random() - 0.5) * 60
        );
    }

    geo.setAttribute("position", new THREE.Float32BufferAttribute(pos, 3));

    const mat = new THREE.PointsMaterial({
        map: particleTexture,
        color: 0xffd700,
        size: 3.5,
        transparent: true,
        blending: THREE.AdditiveBlending,
        depthWrite: false
    });

    magic = new THREE.Points(geo, mat);
    scene.add(magic);
}

// ================================
// ANIMATE
// ================================
function animate() {
    requestAnimationFrame(animate);

    // Snow fall
    const sPos = snow.geometry.attributes.position.array;
    for (let i = 1; i < sPos.length; i += 3) {
        sPos[i] -= 0.4;
        if (sPos[i] < -150) sPos[i] = 150;
    }
    snow.geometry.attributes.position.needsUpdate = true;

    // Magic rotate
    magic.rotation.y += 0.002;
    magic.rotation.x += 0.0015;

    renderer.render(scene, camera);
}

// ================================
// START
// ================================
document.getElementById("startBtn").onclick = () => {
    if (started) return;
    started = true;
    document.getElementById("startBtn").remove();
    document.getElementById("hint").remove();
    init();
};

// ================================
// RESIZE
// ================================
window.addEventListener("resize", () => {
    if (!camera) return;
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
