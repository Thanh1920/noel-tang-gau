<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>üéÑ Qu√† Noel üéÅ</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{overflow:hidden;background:black;font-family:"Segoe UI",sans-serif}
#snow{position:fixed;inset:0;pointer-events:none;z-index:9999}
#scene{width:100vw;height:100vh}
#ui{
    position:absolute;bottom:30px;width:100%;
    text-align:center;z-index:10
}
#ui p{color:rgba(255,255,255,.8);margin-bottom:15px}
#ui button{
    padding:14px 40px;border-radius:30px;
    border:2px solid gold;
    background:linear-gradient(#d32f2f,#8b0000);
    color:white;font-size:16px;font-weight:bold;
    cursor:pointer;animation:pulse 1.5s infinite
}
@keyframes pulse{
    0%{transform:scale(1)}
    50%{transform:scale(1.05)}
    100%{transform:scale(1)}
}
</style>
</head>

<body>

<canvas id="snow"></canvas>
<div id="scene"></div>

<div id="ui">
    <p>üéÅ B·∫•m ƒë·ªÉ m·ªü m√≥n qu√† Noel üéÑ</p>
    <button id="startBtn">M·ªû QU√Ä</button>
</div>

<audio id="music" src="giang_sinh_an_lanh/audio.mp3" loop></audio>

<script>
/* ========= SNOW ========= */
const snow=document.getElementById("snow");
const sctx=snow.getContext("2d");
let sw,sh,flakes=[];
function resizeSnow(){
    sw=snow.width=innerWidth;
    sh=snow.height=innerHeight;
}
window.addEventListener("resize",resizeSnow);
resizeSnow();
function createSnow(){
    flakes=[];
    let count=innerWidth<600?50:120;
    for(let i=0;i<count;i++){
        flakes.push({
            x:Math.random()*sw,
            y:Math.random()*sh,
            r:Math.random()*2+1,
            v:Math.random()*1+0.5
        });
    }
}
createSnow();
function snowLoop(){
    sctx.clearRect(0,0,sw,sh);
    sctx.fillStyle="white";
    flakes.forEach(f=>{
        sctx.beginPath();
        sctx.arc(f.x,f.y,f.r,0,Math.PI*2);
        sctx.fill();
        f.y+=f.v;
        if(f.y>sh){f.y=-5;f.x=Math.random()*sw}
    });
    requestAnimationFrame(snowLoop);
}
snowLoop();

/* ========= THREE JS ========= */
let scene,camera,renderer;
let photoMeshes=[];
const loader=new THREE.TextureLoader();
const photoTextures=[
    loader.load("giang_sinh_an_lanh/image1.jpg"),
    loader.load("giang_sinh_an_lanh/image2.jpg"),
    loader.load("giang_sinh_an_lanh/image3.jpg"),
    loader.load("giang_sinh_an_lanh/image4.jpg"),
    loader.load("giang_sinh_an_lanh/image5.jpg")
];

function startMagic(){
    scene=new THREE.Scene();
    camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,1000);
    camera.position.z=80;

    renderer=new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(innerWidth,innerHeight);
    document.getElementById("scene").appendChild(renderer.domElement);

    // ‚ú® Particles n·ªÅn
    const geo=new THREE.BufferGeometry();
    const count=innerWidth<600?900:2200;
    const pos=[];
    for(let i=0;i<count;i++){
        pos.push(
            (Math.random()-0.5)*60,
            (Math.random()-0.5)*80,
            (Math.random()-0.5)*60
        );
    }
    geo.setAttribute("position",new THREE.Float32BufferAttribute(pos,3));
    const mat=new THREE.PointsMaterial({
        color:0xffd700,size:1.8,transparent:true,
        blending:THREE.AdditiveBlending
    });
    scene.add(new THREE.Points(geo,mat));

    // üñºÔ∏è ·∫¢nh Noel
    photoTextures.forEach((tex,i)=>{
        const geo=new THREE.PlaneGeometry(14,14);
        const mat=new THREE.MeshBasicMaterial({map:tex,transparent:true});
        const mesh=new THREE.Mesh(geo,mat);

        const angle=i*(Math.PI*2/photoTextures.length);
        mesh.position.set(
            Math.sin(angle)*25,
            Math.cos(angle)*10,
            Math.cos(angle)*25
        );
        scene.add(mesh);
        photoMeshes.push(mesh);
    });

    animate();
}

function animate(){
    photoMeshes.forEach((m,i)=>{
        m.rotation.y+=0.01;
        m.position.y=Math.sin(Date.now()*0.001+i)*5;
        m.lookAt(camera.position);
    });
    renderer.render(scene,camera);
    requestAnimationFrame(animate);
}

document.getElementById("startBtn").onclick=()=>{
    document.getElementById("ui").style.display="none";
    document.getElementById("music").play().catch(()=>{});
    startMagic();
};

window.addEventListener("resize",()=>{
    if(camera){
        camera.aspect=innerWidth/innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(innerWidth,innerHeight);
    }
});
</script>

</body>
</html>
